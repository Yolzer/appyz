<ion-header>
  <ion-toolbar color="primary">
    <ion-title>{{ isEditMode ? 'Editar Gasto' : 'Nuevo Gasto' }}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="dismiss()">Cerrar</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <ion-item class="amount-item">
    <ion-label position="stacked">Monto ($)</ion-label>
    <ion-input type="number" placeholder="0" [(ngModel)]="amount" class="amount-input"></ion-input>
  </ion-item>

  <ion-item>
    <ion-label position="floating">Concepto</ion-label>
    <ion-input type="text" placeholder="Ej: Almuerzo" [(ngModel)]="title"></ion-input>
  </ion-item>

  <div class="categories-container ion-margin-top">
    <p>Categor√≠a:</p>
    <ion-chip *ngFor="let cat of categories"
              [color]="category === cat.name ? 'primary' : 'medium'"
              (click)="category = cat.name">
      <ion-icon [name]="cat.icon"></ion-icon>
      <ion-label>{{ cat.name }}</ion-label>
    </ion-chip>
  </div>

  <ion-item>
    <ion-label>Fecha</ion-label>
    <ion-datetime-button datetime="modalDate"></ion-datetime-button>
    <ion-modal [keepContentsMounted]="true">
      <ng-template>
        <ion-datetime id="modalDate" presentation="date" [(ngModel)]="date"></ion-datetime>
      </ng-template>
    </ion-modal>
  </ion-item>

  <ion-item lines="none" class="ion-margin-vertical">
    <ion-label>Foto del Recibo</ion-label>
    <ion-button slot="end" (click)="takePhoto()" fill="outline">
      <ion-icon slot="start" name="camera"></ion-icon>
      {{ receiptImage ? 'Cambiar Foto' : 'Capturar' }}
    </ion-button>
  </ion-item>
  
  <div *ngIf="receiptImage" class="ion-text-center ion-margin-bottom">
    <img [src]="receiptImage" style="max-height: 150px; border-radius: 8px; border: 1px solid #ccc;" />
  </div>

  <ion-button expand="block" size="large" class="ion-margin-top" (click)="save()" [disabled]="!amount || !title">
    {{ isEditMode ? 'Actualizar Gasto' : 'Guardar Gasto' }}
  </ion-button>
</ion-content>